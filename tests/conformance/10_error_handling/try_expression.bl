@prelude(core)

// Conformance: try (?) operator for error propagation

fn safe_divide(a: Int, b: Int) -> Result<Int, String> = {
  if b == 0 then Err("division by zero")
  else Ok(a / b)
}

fn chain_divide(a: Int, b: Int, c: Int) -> Result<Int, String> = {
  let x = safe_divide(a, b)?
  let y = safe_divide(x, c)?
  Ok(y)
}

test "try success" = {
  let result = chain_divide(100, 10, 2)
  Result.unwrap(result) == 5
}

test "try propagates error" = {
  let result = chain_divide(100, 0, 2)
  Result.is_err(result) == true
}
