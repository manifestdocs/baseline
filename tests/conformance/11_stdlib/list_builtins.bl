@prelude(core)

// Conformance: List module builtins

test "length" = List.length([1, 2, 3]) == 3
test "length empty" = List.length([]) == 0
test "head some" = Option.unwrap_or(List.head([1, 2, 3]), 0) == 1
test "head empty" = Option.is_none(List.head([])) == true
test "tail" = List.length(List.tail([1, 2, 3])) == 2
test "map" = {
  let doubled = List.map([1, 2, 3], |x| x * 2)
  List.fold(doubled, 0, |acc, x| acc + x) == 12
}
test "filter" = List.length(List.filter([1, 2, 3, 4, 5], |x| x > 3)) == 2
test "fold sum" = List.fold([1, 2, 3, 4, 5], 0, |acc, x| acc + x) == 15
test "fold product" = List.fold([1, 2, 3, 4], 1, |acc, x| acc * x) == 24
test "find some" = Option.unwrap_or(List.find([10, 20, 30], |x| x == 20), 0) == 20
test "find none" = Option.is_none(List.find([10, 20, 30], |x| x == 99)) == true
test "reverse" = {
  let rev = List.reverse([1, 2, 3])
  List.fold(rev, "", |acc, x| "${acc}${x}") == "321"
}
test "sort" = {
  let sorted = List.sort([3, 1, 4, 1, 5])
  List.fold(sorted, "", |acc, x| "${acc}${x}") == "11345"
}
test "concat" = List.length(List.concat([1, 2], [3, 4, 5])) == 5
