@prelude(server)

// Test Request.decode with refined types

type Name = String where String.length(self) >= 1

type Age = Int where self >= 0 && self <= 150

fn create_handler(req: Request) -> {Http} Result<Response, HttpError> = {
  let result = Request.decode(req, "CreateUser")
  match result
    Ok(user) -> Ok(Response.json(user))
    Err(resp) -> Err(HttpError.unprocessable("validation failed"))
}

fn main!() -> () = {
  Console.println!("ok")
}
