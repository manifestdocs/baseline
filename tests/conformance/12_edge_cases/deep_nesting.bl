@prelude(core)

// Conformance: deeply nested expressions and structures

test "nested if" = {
  let x = if true then
    if true then
      if true then 42
      else 0
    else 0
  else 0
  x == 42
}

test "nested let" = {
  let a = {
    let b = {
      let c = {
        let d = 10
        d + 1
      }
      c + 1
    }
    b + 1
  }
  a == 13
}

test "nested function calls" = {
  let f = |x| x + 1
  let g = |x| x * 2
  let h = |x| x - 3
  h(g(f(5))) == 9
}

test "deep arithmetic" = {
  let a = 1 + 2 + 3 + 4 + 5
  let b = a * 2
  let c = b - 10
  let d = c / 5
  d == 4
}
