// Trait inheritance (supertraits)
// Tests that traits can require other traits

trait Eq {
  eq : (Self, Self) -> Bool
}

trait Ord : Eq {
  compare : (Self, Self) -> Int
}

impl Eq for Int {
  fn eq(a: Int, b: Int) -> Bool = a == b
}

impl Ord for Int {
  fn compare(a: Int, b: Int) -> Int = if a < b then 0 - 1 else if a > b then 1 else 0
}

// Multi-level: Debug : Show
trait Show {
  show : Self -> String
}

trait Debug : Show {
  debug : Self -> String
}

impl Show for Bool {
  fn show(b: Bool) -> String = if b then "true" else "false"
}

impl Debug for Bool {
  fn debug(b: Bool) -> String = "Debug(${Show.show(b)})"
}

fn main() -> Int = 0

test "supertrait method works" = Eq.eq(42, 42) == true
test "subtrait method works" = Ord.compare(1, 2) == 0 - 1
test "multi-level show" = Show.show(true) == "true"
test "multi-level debug" = Debug.debug(true) == "Debug(true)"
