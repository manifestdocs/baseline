@prelude(script)

// Tier 1: Insertion sort â€” lists, recursion, HOFs

fn insert(x: Int, sorted: List<Int>) -> List<Int> = {
  if List.length(sorted) == 0 then [x]
  else {
    let h = Option.unwrap(List.head(sorted))
    if x <= h then List.concat([x], sorted)
    else List.concat([h], insert(x, List.tail(sorted)))
  }
}

fn insertion_sort(lst: List<Int>) -> List<Int> = {
  List.fold(lst, [], |sorted, x| insert(x, sorted))
}

fn main!() -> {Console} () = {
  let nums = [5, 3, 8, 1, 9, 2, 7, 4, 6]
  let sorted = insertion_sort(nums)
  Console.println!("input:  ${nums}")
  Console.println!("sorted: ${sorted}")
}
