================================================================================
Effect definition
================================================================================

effect Console {
  print! : String -> String
  read_line! : String -> String
}

--------------------------------------------------------------------------------

(source_file
  (effect_def
    (type_identifier)
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (type_identifier)))
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (type_identifier)))))

================================================================================
Effect with multiple operations
================================================================================

effect Random {
  int! : Int -> Int
  float! : Int -> Int
}

--------------------------------------------------------------------------------

(source_file
  (effect_def
    (type_identifier)
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (type_identifier)))
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (type_identifier)))))

================================================================================
Effect with tuple type in signature
================================================================================

effect Console {
  print! : String -> (String, String)
  read_line! : () -> String
}

--------------------------------------------------------------------------------

(source_file
  (effect_def
    (type_identifier)
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (tuple_type
          (type_identifier)
          (type_identifier))))
    (function_signature
      (effect_identifier)
      (type_signature
        (tuple_type)
        (type_identifier)))))

================================================================================
Effect with generic type in signature
================================================================================

effect Storage {
  get! : String -> List<String>
}

--------------------------------------------------------------------------------

(source_file
  (effect_def
    (type_identifier)
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (generic_type
          (type_identifier)
          (type_identifier))))))

================================================================================
Effectful function with effect set
================================================================================

fetch! : String -> {Http} String
fetch! = |url| Http.get!(url)

--------------------------------------------------------------------------------

(source_file
  (function_def
    name: (effect_identifier)
    signature: (type_signature
      (type_identifier)
      (effect_set
        (type_identifier))
      (type_identifier))
    name: (effect_identifier)
    body: (lambda
      (identifier)
      (call_expression
        (field_expression
          (type_identifier)
          (effect_identifier))
        (identifier)))))

================================================================================
Multi-effect function with block
================================================================================

log! : String -> {Log, Console} String
log! = |msg| {
  Log.info!(msg);
  Console.print!(msg)
}

--------------------------------------------------------------------------------

(source_file
  (function_def
    name: (effect_identifier)
    signature: (type_signature
      (type_identifier)
      (effect_set
        (type_identifier)
        (type_identifier))
      (type_identifier))
    name: (effect_identifier)
    body: (lambda
      (identifier)
      (block
        (call_expression
          (field_expression
            (type_identifier)
            (effect_identifier))
          (identifier))
        (call_expression
          (field_expression
            (type_identifier)
            (effect_identifier))
          (identifier))))))

================================================================================
Export effect
================================================================================

export effect MyEffect {
  do_thing! : Int -> String
}

--------------------------------------------------------------------------------

(source_file
  (effect_def
    (type_identifier)
    (function_signature
      (effect_identifier)
      (type_signature
        (type_identifier)
        (type_identifier)))))

================================================================================
Calling effectful operations
================================================================================

main! : String -> {Console} String
main! = |s| Console.print!(s)

--------------------------------------------------------------------------------

(source_file
  (function_def
    name: (effect_identifier)
    signature: (type_signature
      (type_identifier)
      (effect_set
        (type_identifier))
      (type_identifier))
    name: (effect_identifier)
    body: (lambda
      (identifier)
      (call_expression
        (field_expression
          (type_identifier)
          (effect_identifier))
        (identifier)))))
