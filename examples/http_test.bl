// HTTP Client example — demonstrates the Http effect module with structured responses
@prelude(script)

// Simple GET request — returns Response record { status, headers, body }
fn fetch!(url: String) -> {Http} { status: Int, headers: List<(String, String)>, body: String } = Http.get!(url)

// POST with body — returns Response record
fn post_data!(url: String, body: String) -> {Http} { status: Int, headers: List<(String, String)>, body: String } = Http.post!(url, body)

// Flexible request via Request record
fn send_request!(req: { method: String, url: String, headers: List<(String, String)>, body: String }) -> {Http} { status: Int, headers: List<(String, String)>, body: String } = Http.request!(req)

// Combined effects: fetch and print the response body
fn fetch_and_log!(url: String) -> {Http, Console} () = {
  let response = Http.get!(url)
  Console.println!(response.body)
}

fn main!() -> {Http, Console} () = {
  let response = Http.get!("https://httpbin.org/get")
  Console.println!("Status: ${response.status}")
  Console.println!(response.body)
}
